var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function r(t){t.forEach(n)}function s(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}const a="undefined"!=typeof window;let c=a?()=>window.performance.now():()=>Date.now(),u=a?t=>requestAnimationFrame(t):t;const l=new Set;function d(t){l.forEach((e=>{e.c(t)||(l.delete(e),e.f())})),0!==l.size&&u(d)}function f(t,e){t.appendChild(e)}function p(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function g(t){const e=$("style");return function(t,e){f(t.head||t,e)}(p(t),e),e.sheet}function h(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function $(t){return document.createElement(t)}function y(){return t=" ",document.createTextNode(t);var t}function x(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e,n){t.classList[n?"add":"remove"](e)}const w=new Map;let k,C=0;function _(t,e,n,o,r,s,i,a=0){const c=16.666/o;let u="{\n";for(let t=0;t<=1;t+=c){const o=e+(n-e)*s(t);u+=100*t+`%{${i(o,1-o)}}\n`}const l=u+`100% {${i(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(l)}_${a}`,f=p(t),{stylesheet:h,rules:m}=w.get(f)||function(t,e){const n={stylesheet:g(e),rules:{}};return w.set(t,n),n}(f,t);m[d]||(m[d]=!0,h.insertRule(`@keyframes ${d} ${l}`,h.cssRules.length));const $=t.style.animation||"";return t.style.animation=`${$?`${$}, `:""}${d} ${o}ms linear ${r}ms 1 both`,C+=1,d}function E(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),r=n.length-o.length;r&&(t.style.animation=o.join(", "),C-=r,C||u((()=>{C||(w.forEach((t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}})),w.clear())})))}function N(t){k=t}function S(t){(function(){if(!k)throw new Error("Function called outside component initialization");return k})().$$.on_mount.push(t)}const T=[],O=[],L=[],R=[],F=Promise.resolve();let B=!1;function D(t){L.push(t)}const M=new Set;let P,A=0;function G(){const t=k;do{for(;A<T.length;){const t=T[A];A++,N(t),j(t.$$)}for(N(null),T.length=0,A=0;O.length;)O.pop()();for(let t=0;t<L.length;t+=1){const e=L[t];M.has(e)||(M.add(e),e())}L.length=0}while(T.length);for(;R.length;)R.pop()();B=!1,M.clear(),N(t)}function j(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(D)}}function z(t,e,n){t.dispatchEvent(function(t,e,n=!1){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,!1,e),o}(`${e?"intro":"outro"}${n}`))}const H=new Set;let I;function W(t,e){t&&t.i&&(H.delete(t),t.i(e))}function q(t,e,n,o){if(t&&t.o){if(H.has(t))return;H.add(t),I.c.push((()=>{H.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}const K={duration:0};function X(n,o,i,a){let f=o(n,i),p=a?0:1,g=null,h=null,m=null;function $(){m&&E(n,m)}function y(t,e){const n=t.b-p;return e*=Math.abs(n),{a:p,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function x(o){const{delay:s=0,duration:i=300,easing:a=e,tick:x=t,css:b}=f||K,v={start:c()+s,b:o};o||(v.group=I,I.r+=1),g||h?h=v:(b&&($(),m=_(n,p,o,i,s,a,b)),o&&x(0,1),g=y(v,i),D((()=>z(n,o,"start"))),function(t){let e;0===l.size&&u(d),new Promise((n=>{l.add(e={c:t,f:n})}))}((t=>{if(h&&t>h.start&&(g=y(h,i),h=null,z(n,g.b,"start"),b&&($(),m=_(n,p,g.b,g.duration,0,a,f.css))),g)if(t>=g.end)x(p=g.b,1-p),z(n,g.b,"end"),h||(g.b?$():--g.group.r||r(g.group.c)),g=null;else if(t>=g.start){const e=t-g.start;p=g.a+g.d*a(e/g.duration),x(p,1-p)}return!(!g&&!h)})))}return{run(t){s(f)?(P||(P=Promise.resolve(),P.then((()=>{P=null}))),P).then((()=>{f=f(),x(t)})):x(t)},end(){$(),g=h=null}}}function J(t){t&&t.c()}function Q(t,e,o,i){const{fragment:a,on_mount:c,on_destroy:u,after_update:l}=t.$$;a&&a.m(e,o),i||D((()=>{const e=c.map(n).filter(s);u?u.push(...e):r(e),t.$$.on_mount=[]})),l.forEach(D)}function U(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function V(t,e){-1===t.$$.dirty[0]&&(T.push(t),B||(B=!0,F.then(G)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Y(e,n,s,i,a,c,u,l=[-1]){const d=k;N(e);const f=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:o(),dirty:l,skip_bound:!1,root:n.target||d.$$.root};u&&u(f.root);let p=!1;if(f.ctx=s?s(e,n.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=r)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](r),p&&V(e,t)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!i&&i(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(m)}else f.fragment&&f.fragment.c();n.intro&&W(e.$$.fragment),Q(e,n.target,n.anchor,n.customElement),G()}N(d)}class Z{$destroy(){U(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function tt(t){const e=t-1;return e*e*e+1}function et(t){let e,n,o;return{c(){e=$("div"),e.innerHTML='<p class="svelte-1a2k4xr"><span class="title svelte-1a2k4xr">GutenBard</span> is a tool for improvisational writing.\n            It uses a neural network trained on Hemingway&#39;s written works to suggest new words based on your inputs.\n            With power of computer, please make weird!</p> \n        <p class="svelte-1a2k4xr">Built by <a href="http://flatpickles.com" class="svelte-1a2k4xr">this guy</a>. Dig the code <a href="https://github.com/flatpickles/GutenBard" class="svelte-1a2k4xr">over here</a>.</p>',b(e,"class","about svelte-1a2k4xr")},m(t,n){h(t,e,n),o=!0},i(r){o||(D((()=>{n||(n=X(e,t[1],{duration:200},!0)),n.run(1)})),o=!0)},o(r){n||(n=X(e,t[1],{duration:200},!1)),n.run(0),o=!1},d(t){t&&m(e),t&&n&&n.end()}}}function nt(t){let e,n,o,s,i,a,c=t[0]&&et(t);return{c(){e=$("div"),c&&c.c(),n=y(),o=$("span"),o.textContent="?!",b(o,"id","icon"),b(o,"class","svelte-1a2k4xr"),v(o,"selected",t[0]),b(e,"class","wrapper svelte-1a2k4xr")},m(r,u){h(r,e,u),c&&c.m(e,null),f(e,n),f(e,o),s=!0,i||(a=x(o,"click",t[2]),i=!0)},p(t,[s]){t[0]?c?1&s&&W(c,1):(c=et(t),c.c(),W(c,1),c.m(e,n)):c&&(I={r:0,c:[],p:I},q(c,1,1,(()=>{c=null})),I.r||r(I.c),I=I.p),1&s&&v(o,"selected",t[0])},i(t){s||(W(c),s=!0)},o(t){q(c),s=!1},d(t){t&&m(e),c&&c.d(),i=!1,a()}}}function ot(t,e,n){let o=!1;return[o,function(t,e){const n=function(t,{delay:e=0,duration:n=400,easing:o=tt}={}){const r=getComputedStyle(t),s=+r.opacity,i=parseFloat(r.height),a=parseFloat(r.paddingTop),c=parseFloat(r.paddingBottom),u=parseFloat(r.marginTop),l=parseFloat(r.marginBottom),d=parseFloat(r.borderTopWidth),f=parseFloat(r.borderBottomWidth);return{delay:e,duration:n,easing:o,css:t=>`overflow: hidden;opacity: ${Math.min(20*t,1)*s};height: ${t*i}px;padding-top: ${t*a}px;padding-bottom: ${t*c}px;margin-top: ${t*u}px;margin-bottom: ${t*l}px;border-top-width: ${t*d}px;border-bottom-width: ${t*f}px;`}}(t,e);return{duration:e.duration,css:t=>`\n\t\t\t\t${n.css(t)}\n\t\t\t\topacity: ${t};\n\t\t\t`}},function(){n(0,o=!o)}]}class rt extends Z{constructor(t){super(),Y(this,t,ot,nt,i,{})}}class st{constructor(t){this.divElement=t}getCurrentCaretPosition(){var t,e=window.getSelection(),n=-1;if(e.focusNode&&this._isChildOf(e.focusNode,this.divElement))for(t=e.focusNode,n=e.focusOffset;t&&t!==this.divElement;)if(t.previousSibling)n+=(t=t.previousSibling).textContent.length;else if(null===(t=t.parentNode))break;return n}setCurrentCaretPosition(t){if(t>=0){var e=window.getSelection();let n=this._createRange(this.divElement,{count:t});n&&(n.collapse(!1),e.removeAllRanges(),e.addRange(n))}}_createRange(t,e,n){if(n||((n=document.createRange()).selectNode(t),n.setStart(t,0)),0===e.count)n.setEnd(t,e.count);else if(t&&e.count>0)if(t.nodeType===Node.TEXT_NODE)t.textContent.length<e.count?e.count-=t.textContent.length:(n.setEnd(t,e.count),e.count=0);else for(var o=0;o<t.childNodes.length&&(n=this._createRange(t.childNodes[o],e,n),0!==e.count);o++);return n}_isChildOf(t,e){for(;null!==t;){if(t===e)return!0;t=t.parentNode}return!1}}class it{modelLoaded=!1;generating=!1;nextSeed=null;nextCallback=null;static defaultString="Once upon a time ";static temperature=.7;static inputLength=35;static outputLength=35;async loadModel(t){this.modelLoaded=!1;const e=this;return this.rnn=ml5.charRNN("models/hemingway/",(t=>{e.modelLoaded=!0})),this.rnn.ready}cancelGeneration(){this.cancelNextGeneration=!0}generate(t,e){if(this.modelLoaded||e(null),0!==t.length)if(this.generating)this.nextSeed=t,this.nextCallback=e;else{let n=t.substring(t.length-it.inputLength);this.generating=!0;const o={seed:n,temperature:it.temperature,length:it.outputLength},r=this;this.cancelNextGeneration=!1,this.rnn.generate(o).then((t=>{if(r.generating=!1,this.cancelNextGeneration)return;let n=t.sample;n=n.replace(/(\r\n|\n|\r)/gm," "),n=n.replace(/\s+/g," "),n.indexOf("nigg")>=0&&(n=n.replace("nigg","tig"));const o=n.lastIndexOf(" ");n=n.substring(0,o),e&&r.nextSeed?(e(null),r.generate(r.nextSeed,r.nextCallback),r.nextSeed=null,r.nextCallback=null):e&&e(n)}))}else e(it.defaultString)}}function at(e){let n,o,s,i;return{c(){n=$("div"),o=$("span"),o.textContent=`${it.defaultString}`,b(o,"id","secondaryText"),b(n,"contenteditable","true"),b(n,"class","svelte-1u64lc1")},m(t,r){h(t,n,r),f(n,o),e[3](n),s||(i=[x(n,"click",e[2]),x(n,"keydown",e[1]),x(n,"paste",lt)],s=!0)},p:t,i:t,o:t,d(t){t&&m(n),e[3](null),s=!1,r(i)}}}function ct(t){setTimeout(t,100)}function ut(){const t=document.getElementById("secondaryText");t&&t.remove()}const lt=t=>{t.preventDefault()};function dt(t,e,n){let o,r,s=new it,i=0;function a(t,e){console.log(window.getSelection());const n=o.getCurrentCaretPosition();let a=r.innerText.substring(0,n),u=n>i||!0===t;if(!u||!0===e){s.cancelGeneration();c(r.innerText.substring(0,n),u?"":r.innerText.substring(n,r.innerText.length),n)}var l;u&&(l=a,s.generate(l,(t=>{t&&c(l,t)})),console.log("generating"))}function c(t,e,s){s||(s=o.getCurrentCaretPosition());const a=t?"<span id='primaryText'>"+t+"</span>":"",c=e?"<span id='secondaryText'>"+e+"</span>":"";n(0,r.innerHTML=a+c,r),o.setCurrentCaretPosition(s),i=s}return S((async()=>{r.focus(),s.loadModel()})),t.$$.update=()=>{1&t.$$.dirty&&(o=new st(r))},[r,function(t){if("Enter"===t.key)return void t.preventDefault();const e=window.getSelection();e.anchorOffset==e.focusOffset?t.metaKey||"9"!=t.keyCode&&"16"!=t.keyCode&&"17"!=t.keyCode&&"18"!=t.keyCode&&"91"!=t.keyCode&&("37"==t.keyCode||"38"==t.keyCode||"39"==t.keyCode||"40"==t.keyCode?ct((()=>{a(!1,!0)})):"8"==t.keyCode||"46"==t.keyCode?(ut(),ct((()=>{a(!0,!1)}))):(ut(),ct(a))):t.preventDefault()},function(t){const e=window.getSelection();e.anchorOffset==e.focusOffset&&a(!1,!0)},function(t){O[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}class ft extends Z{constructor(t){super(),Y(this,t,dt,at,i,{})}}function pt(e){let n,o,r,s,i;return o=new rt({}),s=new ft({}),{c(){n=$("main"),J(o.$$.fragment),r=y(),J(s.$$.fragment),b(n,"class","svelte-jstzcz")},m(t,e){h(t,n,e),Q(o,n,null),f(n,r),Q(s,n,null),i=!0},p:t,i(t){i||(W(o.$$.fragment,t),W(s.$$.fragment,t),i=!0)},o(t){q(o.$$.fragment,t),q(s.$$.fragment,t),i=!1},d(t){t&&m(n),U(o),U(s)}}}return new class extends Z{constructor(t){super(),Y(this,t,null,pt,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
